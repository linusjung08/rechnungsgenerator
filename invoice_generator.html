<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rechnungsgenerator</title>
  <meta name="description" content="Ein einfacher, frei nutzbarer Rechnungsgenerator mit Mehrwertsteuer-Berechnung und PDF-Export." />
  <style>
    :root{font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;--accent:#0b74de}
    body{margin:0;padding:24px;background:#f7f9fc;color:#111}
    .container{max-width:980px;margin:0 auto;background:white;padding:20px;border-radius:10px;box-shadow:0 6px 18px rgba(15,23,42,.06)}
    h1,h2{margin:0 0 12px;font-size:20px}
    label{display:block;font-size:13px;margin-bottom:6px}
    input[type=text], input[type=number], select{width:100%;padding:8px;border-radius:6px;border:1px solid #e6eef8;margin-bottom:12px}
    table{width:100%;border-collapse:collapse;margin-top:6px}
    th,td{padding:8px;border:1px solid #eef4fb;text-align:left}
    .row-actions{display:flex;gap:8px}
    button{background:var(--accent);color:white;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}
    button.ghost{background:transparent;color:var(--accent);border:1px solid #dbeefc}
    .muted{font-size:13px;color:#556}
    .totals{margin-top:12px;text-align:right}
    .totals div{margin:6px 0}
    .flex{display:flex;gap:12px}
    .flex > *{flex:1}
    .small{font-size:13px}
    nav {margin-bottom:12px}
    nav a {margin-right:12px; text-decoration:none; color:var(--accent); cursor:pointer}
    .modal {display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); justify-content:center; align-items:center; z-index:1000;}
    .modal-content {background:white; padding:20px; border-radius:8px; max-width:600px; max-height:80%; overflow:auto;}
    .close {float:right; cursor:pointer; font-weight:bold;}
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
</head>
<body>
  <div class="container" id="invoice-app">

    <h1>Rechnungsgenerator</h1>

    <nav>
      <a id="show-impressum">Impressum</a>
      <a id="show-datenschutz">Datenschutzerklärung</a>
    </nav>

    <section id="invoice-section">
      <div class="flex">
        <div>
          <label>Rechnung von (Ihr Name / Firma)</label>
          <input id="from" type="text" value="Max Mustermann" />
        </div>
        <div>
          <label>Rechnung an (Kunde)</label>
          <input id="to" type="text" value="Kunde AG" />
        </div>
      </div>

      <div class="flex">
        <div>
          <label>Rechnungsnummer</label>
          <input id="inv-no" type="text" value="2025-0001" />
        </div>
        <div>
          <label>Datum</label>
          <input id="date" type="date" />
        </div>
      </div>

      <table id="items-table">
        <thead>
          <tr><th>Beschreibung</th><th>Menge</th><th>Preis (netto)</th><th>MwSt %</th><th>Summe</th><th></th></tr>
        </thead>
        <tbody id="items-body"></tbody>
      </table>
      <div style="margin-top:8px; display:flex; justify-content:space-between; align-items:center">
        <button id="add-row">+ Position hinzufügen</button>
      </div>

      <div class="totals">
        <div>Zwischensumme (netto): <strong id="subtotal">0.00 €</strong></div>
        <div>Gesamt MwSt: <strong id="tax-total">0.00 €</strong></div>
        <div>Gesamt (brutto): <strong id="grand-total">0.00 €</strong></div>
      </div>

      <div style="margin-top:12px; display:flex; gap:8px">
        <button id="download-pdf">Als PDF speichern</button>
        <button class="ghost" id="reset">Zurücksetzen</button>
      </div>
    </section>

  </div>

  <!-- Modals -->
  <div class="modal" id="modal-impressum">
    <div class="modal-content">
      <span class="close" id="close-impressum">✕</span>
      <h2>Impressum</h2>
      <p>Linus Jung<br>Kleimanns Weg 7<br>59394 Nordkirchen<br>E-Mail: linus.jung08@gmail.com</p>
      <p>Verantwortlich für den Inhalt nach § 55 Abs. 2 RStV:<br>Linus Jung<br>Kleimanns Weg 7<br>59394 Nordkirchen</p>
    </div>
  </div>

  <div class="modal" id="modal-datenschutz">
    <div class="modal-content">
      <span class="close" id="close-datenschutz">✕</span>
      <h2>Datenschutzerklärung</h2>
      <p><strong>1. Verantwortlicher</strong><br>Linus Jung<br>E-Mail: linus.jung08@gmail.com</p>
      <p><strong>2. Erhebung und Speicherung personenbezogener Daten</strong><br>Beim Besuch dieser Website werden automatisch technische Informationen erfasst (z. B. Browsertyp, Betriebssystem, Uhrzeit des Seitenaufrufs). Diese Daten dienen ausschließlich der sicheren Bereitstellung und statistischen Auswertung.</p>
      <p><strong>3. Cookies und Tracking (Google Analytics)</strong><br>Diese Website verwendet Google Analytics, IP-Adresse anonymisiert. Opt-Out: <a href="https://tools.google.com/dlpage/gaoptout?hl=de" target="_blank">Link</a>.</p>
      <p><strong>4. Google Ads</strong><br>Diese Website verwendet Google Ads. Weitere Infos: <a href="https://policies.google.com/technologies/ads?hl=de" target="_blank">Link</a>.</p>
      <p><strong>5. Rechtsgrundlage</strong><br>Einwilligung gemäß Art. 6 Abs. 1 lit. a DSGVO. Widerruf jederzeit möglich.</p>
      <p><strong>6. Rechte</strong><br>Auskunft, Berichtigung, Löschung, Einschränkung, Widerspruch, Datenübertragbarkeit an: linus.jung08@gmail.com</p>
      <p><strong>7. Löschung</strong><br>Daten werden gelöscht, sobald der Zweck entfällt oder Widerruf erfolgt.</p>
      <p><strong>8. Aufsichtsbehörde</strong><br>Recht zur Beschwerde bei Datenschutzaufsichtsbehörde.</p>
    </div>
  </div>

  <script>
    const fmt = n => Number(n).toLocaleString('de-DE',{minimumFractionDigits:2,maximumFractionDigits:2})+' €';
    const parse = v => Number(String(v).replace(',', '.')) || 0;

    const itemsBody = document.getElementById('items-body');
    const subtotalEl = document.getElementById('subtotal');
    const taxTotalEl = document.getElementById('tax-total');
    const grandTotalEl = document.getElementById('grand-total');

    function makeRow(desc='', qty=1, price=0, tax=19){
      const tr = document.createElement('tr');
      tr.innerHTML=`
        <td><input class='desc' type='text' value='${desc}'></td>
        <td><input class='qty' type='number' min='0' step='1' value='${qty}'></td>
        <td><input class='price' type='number' min='0' step='0.01' value='${price}'></td>
        <td><input class='tax' type='number' min='0' step='0.01' value='${tax}'></td>
        <td class='line-sum'>0.00 €</td>
        <td><div class='row-actions'><button class='del ghost'>✕</button></div></td>
      `;
      tr.querySelectorAll('input').forEach(inp=>inp.addEventListener('input', recalc));
      tr.querySelector('.del').addEventListener('click', ()=>{ tr.remove(); recalc(); });
      return tr;
    }

    function addDefaultRows(){
      itemsBody.appendChild(makeRow('Beratung',1,120,19));
      itemsBody.appendChild(makeRow('Design',2,75,19));
    }

    function recalc(){
      let subtotal=0, taxTotal=0;
      Array.from(itemsBody.querySelectorAll('tr')).forEach(tr=>{
        const qty=parse(tr.querySelector('.qty').value);
        const price=parse(tr.querySelector('.price').value);
        const tax=parse(tr.querySelector('.tax').value);
        const lineNet=qty*price;
        const lineTax=lineNet*(tax/100);
        const lineSum=lineNet+lineTax;
        tr.querySelector('.line-sum').textContent=fmt(lineSum);
        subtotal+=lineNet;
        taxTotal+=lineTax;
      });
      subtotalEl.textContent=fmt(subtotal);
      taxTotalEl.textContent=fmt(taxTotal);
      grandTotalEl.textContent=fmt(subtotal+taxTotal);
    }

    document.getElementById('add-row').addEventListener('click', ()=>{ itemsBody.appendChild(makeRow()); recalc(); });
    document.getElementById('reset').addEventListener('click', ()=>{ itemsBody.innerHTML=''; addDefaultRows(); recalc(); });

    document.getElementById('download-pdf').addEventListener('click', ()=>{
      const clone=document.createElement('div');
      clone.innerHTML='<h1>Rechnung</h1>'+document.getElementById('items-table').outerHTML;
      clone.innerHTML+='<div>Zwischensumme: '+subtotalEl.textContent+'</div>';
      clone.innerHTML+='<div>Gesamt MwSt: '+taxTotalEl.textContent+'</div>';
      clone.innerHTML+='<div>Gesamt: '+grandTotalEl.textContent+'</div>';
      const opt={margin:0.4, filename:(document.getElementById('inv-no').value||'rechnung')+'.pdf', image:{type:'jpeg',quality:0.98}, html2canvas:{scale:2,useCORS:true}, jsPDF:{unit:'in',format:'a4',orientation:'portrait'}};
      html2pdf().set(opt).from(clone).save();
    });

    // Modal handling
    document.getElementById('show-impressum').addEventListener('click', ()=>{ document.getElementById('modal-impressum').style.display='flex'; });
    document.getElementById('close-impressum').addEventListener('click', ()=>{ document.getElementById('modal-impressum').style.display='none'; });
    document.getElementById('show-datenschutz').addEventListener('click', ()=>{ document.getElementById('modal-datenschutz').style.display='flex'; });
    document.getElementById('close-datenschutz').addEventListener('click', ()=>{ document.getElementById('modal-datenschutz').style.display='none'; });

    (function(){
      document.getElementById('date').value=new Date().toISOString().slice(0,10);
      addDefaultRows();
      recalc();
    })();
  </script>
</body>
</html>

